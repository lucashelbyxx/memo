内存管理

从平地到万丈高楼

“谁敢说自己的课程是万丈高楼呢？我敢。” —— 侯捷

从 C++ 领域去怎么分配内存的基本工具一直到高阶的怎么去管理它，包括对于标准库里头的分配器是怎么管理的。包括对于最底层的 memory allocation，叫 malloc 这个函数，这里头是怎么管理内存的，我们都要很深入的去看它的动作。从这些动作，从这些学习里面，我们就能很清楚的知道我们到底还要不要做内存管理。我们印象中需要做的管理，其实我们在用的东西，标准库、函数都已经做到了。这个过程中，不但可以知道业界知名的管理器它们是怎么做的，“*他山之石*，*可以攻*玉”。另一方面可以检讨有些印象是错误的，也许你不用再做内存管理，应该那些管理已经够了。

*万丈高楼平地起*

*源码之前，了无秘密*



你应具备的基础

- 曾经动态分配并使用 memory
- 曾经使用过 C++ 标准库的容器 (container)

C++ 发展到现在很希望大家直接用标准库的容器，不用再去关心内存了，在应用面上。当然我们还是希望大家知道里头是怎么运作，来龙去脉，心中有一张图，但是我们不用去take care那些很复杂的动作。容器跟分配器、内存有什么关系呢？容器背后有一个分配器allocator来支持它。分配器有很多，不同的编译器所带标准库的容器它背后的分配器的做法都不一样。深入理解这些东西你就可以选择用哪套分配器来作为容器的支撑效率会最好。



我们的目标

从平地当万丈高楼，从最基础的 C++ 语言构件，到高知名度的内存管理器，彻底了解高高低低的方方面面。